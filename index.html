<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>한국레이더시스템 - 주요 납품 실적</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
    
    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <!-- Chart.js for Bar Chart -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f8fafc; /* bg-slate-50 */
            color: #1e293b; /* bg-slate-800 */
            background-image: radial-gradient(#e2e8f0 1px, transparent 1px);
            background-size: 20px 20px;
        }
        .solution-card, .region-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
        }
        .solution-card:hover, .region-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .region-card.active {
            border-color: #3b82f6; /* blue-500 */
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
            transform: translateY(-5px);
        }
        /* Custom scrollbar for info panel */
        #info-list::-webkit-scrollbar { width: 6px; }
        #info-list::-webkit-scrollbar-track { background: #e2e8f0; }
        #info-list::-webkit-scrollbar-thumb { background: #9ca3af; border-radius: 3px; }
        #info-list::-webkit-scrollbar-thumb:hover { background: #6b7280; }
        
        /* Transition for info details panel */
        #performance-info {
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            max-height: 0;
            overflow: hidden;
        }
        #performance-info.open {
            max-height: 1000px; /* Large enough to not clip content */
            padding-top: 2rem;
            padding-bottom: 2rem;
        }
        .animated-gradient-bg {
            background: linear-gradient(-45deg, #f1f5f9, #e0e7ff, #f8fafc, #dbeafe);
            background-size: 400% 400%;
            animation: gradient-animation 15s ease infinite;
        }
        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
    </style>
</head>
<body class="bg-slate-100">

    <div class="container mx-auto p-4 md:p-8">
        
        <header class="text-center mb-12 py-10 rounded-lg animated-gradient-bg">
            <h1 class="text-4xl md:text-5xl font-black text-gray-900">주요 납품 실적</h1>
            <p class="text-lg text-gray-600 mt-2">전국 각지에 한국레이더시스템의 기술이 함께합니다.</p>
        </header>

        <!-- Chart & Summary Section -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12">
            <!-- Chart Section -->
            <div class="lg:col-span-2 bg-white p-6 rounded-lg shadow-lg border border-slate-200">
                <h2 class="text-xl font-bold text-gray-800 mb-4 text-center">지역별 납품 실적 현황</h2>
                <div class="h-96 md:h-[550px]">
                    <canvas id="performanceChart"></canvas>
                </div>
            </div>
            <!-- Summary Panel -->
            <div class="lg:col-span-1 flex flex-col gap-8">
                <div class="w-full bg-white p-6 rounded-lg shadow-lg border border-slate-200 text-center relative overflow-hidden">
                    <i class="ph-map-trifold text-9xl text-slate-100 absolute -right-4 -bottom-4 -rotate-12"></i>
                    <div class="relative z-10">
                        <i class="ph-map-pin-line text-5xl text-blue-500 mx-auto mb-2"></i>
                        <p class="text-slate-500 text-lg">납품 지자체 현황</p>
                        <p id="total-regions" class="text-6xl font-black text-blue-600">0</p>
                    </div>
                </div>
                <div class="w-full bg-white p-6 rounded-lg shadow-lg border border-slate-200">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 text-center flex items-center justify-center">
                        <i class="ph-lightbulb-filament text-2xl text-blue-500 mr-2"></i>
                        주요 납품 솔루션
                    </h3>
                    <div class="space-y-3">
                        <div class="solution-card bg-slate-50 p-3 rounded-lg flex items-center">
                           <div class="w-10 h-10 rounded-md flex items-center justify-center bg-pink-100 mr-3 flex-shrink-0">
                               <i class="ph-number-plate text-2xl text-pink-500"></i>
                           </div>
                           <p class="font-medium text-slate-700 text-sm">차량번호 인식 시스템</p>
                        </div>
                         <div class="solution-card bg-slate-50 p-3 rounded-lg flex items-center">
                           <div class="w-10 h-10 rounded-md flex items-center justify-center bg-blue-100 mr-3 flex-shrink-0">
                               <i class="ph-waves text-2xl text-blue-500"></i>
                           </div>
                           <p class="font-medium text-slate-700 text-sm">스마트 소하천 계측 시스템</p>
                        </div>
                         <div class="solution-card bg-slate-50 p-3 rounded-lg flex items-center">
                            <div class="w-10 h-10 rounded-md flex items-center justify-center bg-yellow-100 mr-3 flex-shrink-0">
                               <i class="ph-intersect text-2xl text-yellow-500"></i>
                           </div>
                           <p class="font-medium text-slate-700 text-sm">스마트 교차로 시스템</p>
                        </div>
                         <div class="solution-card bg-slate-50 p-3 rounded-lg flex items-center">
                           <div class="w-10 h-10 rounded-md flex items-center justify-center bg-purple-100 mr-3 flex-shrink-0">
                               <i class="ph-scan text-2xl text-purple-500"></i>
                           </div>
                           <p class="font-medium text-slate-700 text-sm">지능형 영상분석 시스템</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Region Grid & Info Section -->
        <section>
            <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">전체 지역 보기</h2>
            <p class="text-center text-slate-500 mb-8">아래 지역 카드를 클릭하여 상세 납품처를 확인하세요.</p>
            <div id="region-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
                <!-- Region cards will be injected here by JavaScript -->
            </div>
        </section>

        <!-- Performance Info Panel (Hidden by default, shown on click) -->
        <section id="performance-info" class="mt-8">
            <div class="bg-white p-6 rounded-lg shadow-lg border-2 border-blue-200">
               <div id="info-details">
                   <h3 id="info-title" class="text-2xl font-bold text-gray-900 mb-4 border-b-2 pb-2 border-blue-200 flex justify-between items-center">
                        <span></span>
                        <button id="close-info" class="p-1 rounded-full hover:bg-slate-200 transition-colors">
                            <i class="ph-x text-2xl"></i>
                        </button>
                   </h3>
                   <ul id="info-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-2.5 text-gray-700"></ul>
               </div>
            </div>
        </section>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const performanceData = {
                seoul: { title: '서울', clients: ['동작구청', '서울어린이대공원관리사업소'] },
                gyeonggi: { title: '경기', clients: ['군포시청', '남양주시청', '수원시청', '안산시청', '용인 SLIVCITY'] },
                incheon: { title: '인천', clients: ['강화도', '송도 SLIVCITY'] },
                gangwon: { title: '강원', clients: ['동해시청', '삼척시청', '영월군청', '인제군청', '원주시청', '철원군청', '태백시청', '홍천군청', '춘천시청'] },
                chungbuk: { title: '충북', clients: ['단양군청', '보은군청', '옥천군청', '제천시청', '충청북도 교육청', '한국농어촌공사 충북지역본부'] },
                chungnam: { title: '충남', clients: ['금산군청', '당진시청'] },
                sejong: { title: '세종', clients: ['세종특별자치시'] },
                gyeongbuk: { title: '경북', clients: ['경산시청', '경주시청', '고령군청', '김천시청', '구미시청', '봉화군청', '상주시청', '성주군청', '안동시청', '영양군청', '영주시청', '울진군청', '영천시청', '예천군청', '청도군청', '포항시청', '칠곡군청'] },
                jeonbuk: { title: '전북', clients: ['장수군청'] },
                daegu: { title: '대구', clients: ['대구동구청', '달성군청'] },
                jeonnam: { title: '전남', clients: ['곡성군청', '구례군청', '담양군청', '보성군청', '완도군청', '영암군청', '여수시청', '장흥군청', '한국수력원자력(주)여수한빛원자력본부', '해남군청', '화순군청'] },
                gyeongnam: { title: '경남', clients: ['고성군청', '거창군청', '거제시청', '김해시청', '진주시청', '창녕군청', '통영시청', '하동군청', '함양군청', '합천군청', '함안군청', '사천시청', '창원시청'] },
                ulsan: { title: '울산', clients: ['울산동구청', '울산중구청'] },
                busan: { title: '부산', clients: ['기장군고리원자력발전소', '기장군청', '부산진구청', '부산시청', '부산항만공사'] },
                jeju: { title: '제주', clients: ['제주특별자치도'] },
            };

            const regionGrid = document.getElementById('region-grid');
            const infoPanel = document.getElementById('performance-info');
            const infoTitle = document.querySelector('#info-title span');
            const infoList = document.getElementById('info-list');
            const closeInfoButton = document.getElementById('close-info');
            let chart;
            let activeCard = null;

            function calculateSummary() {
                const totalRegions = Object.keys(performanceData).filter(key => performanceData[key].clients.length > 0).length;
                document.getElementById('total-regions').textContent = totalRegions;
            }

            function getGradientColor(value, maxValue) {
                const startColor = { r: 191, g: 219, b: 254 }; // A light blue (blue-200)
                const endColor = { r: 30, g: 64, b: 175 };    // A dark blue (blue-800)
                const ratio = Math.sqrt(value / maxValue);

                const r = Math.round(startColor.r + (endColor.r - startColor.r) * ratio);
                const g = Math.round(startColor.g + (endColor.g - startColor.g) * ratio);
                const b = Math.round(startColor.b + (endColor.b - startColor.b) * ratio);
                
                return `rgba(${r}, ${g}, ${b}, 0.8)`;
            }

            function createChart() {
                const ctx = document.getElementById('performanceChart').getContext('2d');
                const sortedData = Object.entries(performanceData).sort(([, a], [, b]) => b.clients.length - a.clients.length);
                
                const labels = sortedData.map(([, data]) => data.title);
                const data = sortedData.map(([, data]) => data.clients.length);
                const maxValue = Math.max(...data);

                const backgroundColors = data.map(value => getGradientColor(value, maxValue));
                const hoverBgColors = backgroundColors.map(color => color.replace('0.8', '1'));
                const borderColors = backgroundColors.map(color => color.replace('0.8', '1'));

                chart = new Chart(ctx, {
                    type: 'bar',
                    data: { labels, datasets: [{ label: '납품 건수', data, backgroundColor: backgroundColors, borderColor: borderColors, hoverBackgroundColor: hoverBgColors, borderWidth: 1, borderRadius: 4 }] },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: { x: { beginAtZero: true, grid: { color: '#e2e8f0' }}, y: { grid: { display: false }}},
                        plugins: { 
                            legend: { display: false },
                            tooltip: { callbacks: { label: (context) => ` ${context.raw} 건` } }
                        },
                        onClick: (event, elements) => {
                            if (elements.length > 0) {
                                const regionLabel = chart.data.labels[elements[0].index];
                                const regionId = Object.keys(performanceData).find(key => performanceData[key].title === regionLabel);
                                if (regionId) updateInfo(regionId);
                            }
                        }
                    }
                });
            }

            function updateInfo(regionId) {
                const regionData = performanceData[regionId];
                infoTitle.textContent = regionData.title;
                infoList.innerHTML = regionData.clients.map(client => 
                    `<li class="flex items-start py-1"><i class="ph-check-circle text-blue-500 mt-1 mr-2 flex-shrink-0"></i><span>${client}</span></li>`
                ).join('');
                
                if (!infoPanel.classList.contains('open')) {
                    infoPanel.classList.add('open');
                    setTimeout(() => infoPanel.scrollIntoView({ behavior: 'smooth', block: 'center' }), 100);
                }
                
                if (activeCard) activeCard.classList.remove('active');
                
                const newActiveCard = document.getElementById(`card-${regionId}`);
                if (newActiveCard) {
                    newActiveCard.classList.add('active');
                    activeCard = newActiveCard;
                }

                const data = chart.data.datasets[0].data;
                const labels = chart.data.labels;
                const maxValue = Math.max(...data);

                const backgroundColors = labels.map(label => {
                    const id = Object.keys(performanceData).find(key => performanceData[key].title === label);
                    const value = performanceData[id].clients.length;
                    return getGradientColor(value, maxValue);
                });
                
                const regionIndex = labels.indexOf(regionData.title);
                backgroundColors[regionIndex] = 'rgba(245, 158, 11, 0.9)';
                
                chart.data.datasets[0].backgroundColor = backgroundColors;
                chart.update();
            }

            function createRegionGrid() {
                const sortedRegions = Object.entries(performanceData).sort(([,a],[,b]) => b.clients.length - a.clients.length);
                
                for (const [regionId, data] of sortedRegions) {
                    if (data.clients.length > 0) {
                        const card = document.createElement('div');
                        card.id = `card-${regionId}`;
                        card.className = 'region-card bg-white p-4 rounded-lg shadow-md border-2 border-transparent cursor-pointer text-center';
                        card.innerHTML = `
                            <p class="font-bold text-lg text-gray-800">${data.title}</p>
                            <p class="text-sm text-blue-600">${data.clients.length}건</p>
                        `;
                        card.addEventListener('click', () => updateInfo(regionId));
                        regionGrid.appendChild(card);
                    }
                }
            }
            
            function resetSelections() {
                infoPanel.classList.remove('open');
                if (activeCard) {
                    activeCard.classList.remove('active');
                    activeCard = null;
                }
                
                const data = chart.data.datasets[0].data;
                const labels = chart.data.labels;
                const maxValue = Math.max(...data);
                
                chart.data.datasets[0].backgroundColor = labels.map(label => {
                    const id = Object.keys(performanceData).find(key => performanceData[key].title === label);
                    const value = performanceData[id].clients.length;
                    return getGradientColor(value, maxValue);
                });
                chart.update();
            }

            closeInfoButton.addEventListener('click', resetSelections);

            calculateSummary();
            createChart();
            createRegionGrid();
        });
    </script>
</body>
</html>
